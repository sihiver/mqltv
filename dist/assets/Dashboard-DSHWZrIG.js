import{m as ue,r as h,n as R,p as q,d as t,c as H,o as x,q as L,w as a,b as e,j as p,F as te,s as se,k,t as A,g as V,v as me,x as pe,y as ee,E as c,z as J,A as ce,B as ne,C as oe,D as _e,G as W,H as de,a as N,I as fe,J as ye,K as ve,u as we,L as ge,e as be,l as he,M as xe,N as Ce,O as Ve,P as ke,Q as Ue}from"./index-C_R8r6mj.js";import{_ as K}from"./_plugin-vue_export-helper-DlAUqK2U.js";const X=ue("stats",()=>{const Y=h({total_playlists:0,total_channels:0,active_channels:0,total_relays:0}),$=h({downloadMbps:0,uploadMbps:0,totalDownloadMB:0,totalUploadMB:0});async function C(){try{const d=await R.get("/api/stats");Y.value=d.data}catch(d){console.error("Error loading stats:",d)}}async function r(){try{const d=await R.get("/api/bandwidth");$.value=d.data}catch(d){console.error("Error loading bandwidth:",d)}}return{stats:Y,bandwidth:$,loadStats:C,loadBandwidth:r}}),Pe={class:"playlists-view"},$e={class:"card-header"},Se={class:"playlist-name"},De={class:"playlist-info"},Be={__name:"PlaylistsView",setup(Y){const $=h([]),C=h(!1),r=X(),d=async()=>{try{const _=await R.get("/api/playlists");$.value=_.data||[]}catch(_){console.error("Error loading playlists:",_),c.error("Gagal memuat playlists")}},o=async({action:_,playlist:n})=>{if(_==="view")c.info("Fitur view channels akan segera tersedia");else if(_==="delete")try{await J.confirm(`Apakah Anda yakin ingin menghapus playlist "${n.name}"?`,"Konfirmasi",{confirmButtonText:"Ya",cancelButtonText:"Batal",type:"warning"}),await R.delete(`/api/playlists/${n.id}`),c.success("Playlist berhasil dihapus"),d(),r.loadStats()}catch(f){f!=="cancel"&&c.error("Gagal menghapus playlist")}},S=_=>_?new Date(_).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"-";return q(()=>{d()}),(_,n)=>{const f=t("el-button"),M=t("el-empty"),m=t("el-icon"),s=t("el-dropdown-item"),i=t("el-dropdown-menu"),U=t("el-dropdown"),P=t("el-card"),G=t("el-col"),I=t("el-row");return x(),H("div",Pe,[$.value.length===0?(x(),L(M,{key:0,description:"Belum ada playlist"},{default:a(()=>[e(f,{type:"primary",onClick:n[0]||(n[0]=D=>C.value=!0)},{default:a(()=>[...n[1]||(n[1]=[p("Import M3U",-1)])]),_:1})]),_:1})):(x(),L(I,{key:1,gutter:20},{default:a(()=>[(x(!0),H(te,null,se($.value,D=>(x(),L(G,{key:D.id,xs:24,sm:12,md:8,lg:6},{default:a(()=>[e(P,{class:"playlist-card",shadow:"hover"},{header:a(()=>[k("div",$e,[k("span",Se,A(D.name),1),e(U,{onCommand:o},{dropdown:a(()=>[e(i,null,{default:a(()=>[e(s,{command:{action:"view",playlist:D}},{default:a(()=>[e(m,null,{default:a(()=>[e(V(pe))]),_:1}),n[2]||(n[2]=p(" Lihat Channels ",-1))]),_:1},8,["command"]),e(s,{command:{action:"delete",playlist:D}},{default:a(()=>[e(m,null,{default:a(()=>[e(V(ee))]),_:1}),n[3]||(n[3]=p(" Hapus ",-1))]),_:1},8,["command"])]),_:2},1024)]),default:a(()=>[e(f,{type:"text"},{default:a(()=>[e(m,null,{default:a(()=>[e(V(me))]),_:1})]),_:1})]),_:2},1024)])]),default:a(()=>[k("div",De,[k("p",null,[n[4]||(n[4]=k("strong",null,"ðŸ“º Total Channels:",-1)),p(" "+A(D.channel_count),1)]),k("p",null,[n[5]||(n[5]=k("strong",null,"ðŸ“… Created:",-1)),p(" "+A(S(D.created_at)),1)])])]),_:2},1024)]),_:2},1024))),128))]),_:1}))])}}},Re=K(Be,[["__scopeId","data-v-6e50f0e1"]]),Ie={class:"channels-view"},Me={class:"toolbar"},Le={class:"channel-info"},Te=["src","alt"],Ee={class:"channel-name"},Ge={class:"channel-category"},ze={key:0,ref:"videoPlayer",controls:"",autoplay:"",style:{width:"100%","max-height":"500px"}},Ae=["src"],He={__name:"ChannelsView",setup(Y){const $=h([]),C=h([]),r=h(""),d=h(""),o=h(new Set),S=h(!1),_=h(!1),n=h(null),f=X(),M=ce(()=>{let u=$.value;if(r.value){const w=r.value.toLowerCase();u=u.filter(g=>g.name.toLowerCase().includes(w)||g.category&&g.category.toLowerCase().includes(w))}return d.value&&(u=u.filter(w=>w.category===d.value)),u}),m=async()=>{S.value=!0;try{const u=await R.get("/api/channels");$.value=u.data||[];const w=new Set;$.value.forEach(g=>{g.category&&w.add(g.category)}),C.value=Array.from(w).sort()}catch(u){console.error("Error loading channels:",u),c.error("Gagal memuat channels")}finally{S.value=!1}},s=()=>{},i=()=>{},U=u=>{o.value=new Set(u.map(w=>w.id))},P=u=>{n.value={...u,url:`/stream/${u.id}/playlist.m3u8`},_.value=!0},G=async u=>{try{await R.put(`/api/channels/${u.id}/toggle`),u.enabled=!u.enabled,c.success(`Channel ${u.enabled?"diaktifkan":"dinonaktifkan"}`),f.loadStats()}catch{c.error("Gagal mengubah status channel")}},I=async u=>{try{await J.confirm(`Hapus channel "${u.name}"?`,"Konfirmasi",{confirmButtonText:"Ya",cancelButtonText:"Batal",type:"warning"}),await R.delete(`/api/channels/${u.id}`),c.success("Channel berhasil dihapus"),m(),f.loadStats()}catch(w){w!=="cancel"&&c.error("Gagal menghapus channel")}},D=async()=>{if(o.value.size!==0)try{await J.confirm(`Hapus ${o.value.size} channel yang dipilih?`,"Konfirmasi",{confirmButtonText:"Ya",cancelButtonText:"Batal",type:"warning"});const u=Array.from(o.value);await R.post("/api/channels/batch-delete",{ids:u}),c.success("Channels berhasil dihapus"),o.value.clear(),m(),f.loadStats()}catch(u){u!=="cancel"&&c.error("Gagal menghapus channels")}};return q(()=>{m()}),(u,w)=>{const g=t("el-icon"),v=t("el-input"),l=t("el-option"),z=t("el-select"),B=t("el-button"),E=t("el-table-column"),F=t("el-tag"),O=t("el-table"),T=t("el-dialog"),Q=ne("loading");return x(),H("div",Ie,[k("div",Me,[e(v,{modelValue:r.value,"onUpdate:modelValue":w[0]||(w[0]=b=>r.value=b),placeholder:"ðŸ” Cari channel...",clearable:"",style:{"max-width":"300px"},onInput:s},{prefix:a(()=>[e(g,null,{default:a(()=>[e(V(_e))]),_:1})]),_:1},8,["modelValue"]),e(z,{modelValue:d.value,"onUpdate:modelValue":w[1]||(w[1]=b=>d.value=b),placeholder:"ðŸ“‚ Semua Kategori",clearable:"",style:{"max-width":"200px"},onChange:i},{default:a(()=>[(x(!0),H(te,null,se(C.value,b=>(x(),L(l,{key:b,label:b,value:b},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),e(B,{type:"danger",disabled:o.value.size===0,onClick:D},{default:a(()=>[e(g,null,{default:a(()=>[e(V(ee))]),_:1}),p(" Hapus ("+A(o.value.size)+") ",1)]),_:1},8,["disabled"])]),oe((x(),L(O,{data:M.value,style:{width:"100%","margin-top":"20px"},onSelectionChange:U},{default:a(()=>[e(E,{type:"selection",width:"55"}),e(E,{label:"Channel","min-width":"200"},{default:a(({row:b})=>[k("div",Le,[b.logo?(x(),H("img",{key:0,src:b.logo,alt:b.name,class:"channel-logo"},null,8,Te)):W("",!0),k("div",null,[k("div",Ee,A(b.name),1),k("div",Ge,A(b.category||"Uncategorized"),1)])])]),_:1}),e(E,{label:"Playlist",prop:"playlist_name",width:"150"}),e(E,{label:"Status",width:"100"},{default:a(({row:b})=>[b.enabled?(x(),L(F,{key:0,type:"success"},{default:a(()=>[...w[3]||(w[3]=[p("Active",-1)])]),_:1})):(x(),L(F,{key:1,type:"info"},{default:a(()=>[...w[4]||(w[4]=[p("Inactive",-1)])]),_:1}))]),_:1}),e(E,{label:"Aksi",width:"200",fixed:"right"},{default:a(({row:b})=>[e(B,{type:"primary",size:"small",onClick:j=>P(b)},{default:a(()=>[e(g,null,{default:a(()=>[e(V(de))]),_:1}),w[5]||(w[5]=p(" Play ",-1))]),_:1},8,["onClick"]),e(B,{type:b.enabled?"warning":"success",size:"small",onClick:j=>G(b)},{default:a(()=>[p(A(b.enabled?"Disable":"Enable"),1)]),_:2},1032,["type","onClick"]),e(B,{type:"danger",size:"small",onClick:j=>I(b)},{default:a(()=>[e(g,null,{default:a(()=>[e(V(ee))]),_:1})]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[Q,S.value]]),e(T,{modelValue:_.value,"onUpdate:modelValue":w[2]||(w[2]=b=>_.value=b),title:"Play Channel",width:"80%"},{default:a(()=>[n.value?(x(),H("video",ze,[k("source",{src:n.value.url,type:"application/x-mpegURL"},null,8,Ae)],512)):W("",!0)]),_:1},8,["modelValue"])])}}},Ye=K(He,[["__scopeId","data-v-5ea2b0e2"]]),Fe={class:"relays-view"},Ne={style:{"font-size":"12px"}},Ke={__name:"RelaysView",setup(Y){const $=h([]),C=h(!1),r=h(!1),d=X(),o=N({name:"",source_url:""}),S=async()=>{C.value=!0;try{const m=await R.get("/api/relays");$.value=m.data||[]}catch(m){console.error("Error loading relays:",m),c.error("Gagal memuat relays")}finally{C.value=!1}},_=async()=>{if(!o.name||!o.source_url){c.warning("Nama dan Source URL harus diisi");return}try{await R.post("/api/relays",o),c.success("Relay berhasil dibuat"),r.value=!1,o.name="",o.source_url="",S(),d.loadStats()}catch{c.error("Gagal membuat relay")}},n=async m=>{try{await R.post(`/api/relays/${m.id}/toggle`),m.active=!m.active,c.success(`Relay ${m.active?"diaktifkan":"dinonaktifkan"}`)}catch{c.error("Gagal mengubah status relay")}},f=async m=>{try{await J.confirm(`Hapus relay "${m.name}"?`,"Konfirmasi",{confirmButtonText:"Ya",cancelButtonText:"Batal",type:"warning"}),await R.delete(`/api/relays/${m.id}`),c.success("Relay berhasil dihapus"),S(),d.loadStats()}catch(s){s!=="cancel"&&c.error("Gagal menghapus relay")}},M=m=>{const s=`${window.location.origin}/relay/${m.id}/playlist.m3u8`;navigator.clipboard.writeText(s),c.success("URL berhasil disalin")};return q(()=>{S()}),(m,s)=>{const i=t("el-icon"),U=t("el-button"),P=t("el-table-column"),G=t("el-tag"),I=t("el-table"),D=t("el-input"),u=t("el-form-item"),w=t("el-form"),g=t("el-dialog"),v=ne("loading");return x(),H("div",Fe,[e(U,{type:"primary",onClick:s[0]||(s[0]=l=>r.value=!0),style:{"margin-bottom":"20px"}},{default:a(()=>[e(i,null,{default:a(()=>[e(V(fe))]),_:1}),s[5]||(s[5]=p(" Buat Relay Baru ",-1))]),_:1}),oe((x(),L(I,{data:$.value,style:{width:"100%"}},{default:a(()=>[e(P,{label:"Nama",prop:"name","min-width":"150"}),e(P,{label:"Source URL","min-width":"250"},{default:a(({row:l})=>[k("code",Ne,A(l.source_url),1)]),_:1}),e(P,{label:"Status",width:"120"},{default:a(({row:l})=>[l.active?(x(),L(G,{key:0,type:"success"},{default:a(()=>[e(i,null,{default:a(()=>[e(V(de))]),_:1}),s[6]||(s[6]=p(" Aktif ",-1))]),_:1})):(x(),L(G,{key:1,type:"info"},{default:a(()=>[e(i,null,{default:a(()=>[e(V(ye))]),_:1}),s[7]||(s[7]=p(" Nonaktif ",-1))]),_:1}))]),_:1}),e(P,{label:"Relay URL","min-width":"250"},{default:a(({row:l})=>[e(U,{type:"primary",size:"small",text:"",onClick:z=>M(l)},{default:a(()=>[...s[8]||(s[8]=[p(" ðŸ“‹ Copy URL ",-1)])]),_:1},8,["onClick"])]),_:1}),e(P,{label:"Aksi",width:"200",fixed:"right"},{default:a(({row:l})=>[e(U,{type:l.active?"warning":"success",size:"small",onClick:z=>n(l)},{default:a(()=>[p(A(l.active?"Stop":"Start"),1)]),_:2},1032,["type","onClick"]),e(U,{type:"danger",size:"small",onClick:z=>f(l)},{default:a(()=>[e(i,null,{default:a(()=>[e(V(ee))]),_:1})]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[v,C.value]]),e(g,{modelValue:r.value,"onUpdate:modelValue":s[4]||(s[4]=l=>r.value=l),title:"Buat Relay Baru",width:"500px"},{footer:a(()=>[e(U,{onClick:s[3]||(s[3]=l=>r.value=!1)},{default:a(()=>[...s[9]||(s[9]=[p("Batal",-1)])]),_:1}),e(U,{type:"primary",onClick:_},{default:a(()=>[...s[10]||(s[10]=[p("Simpan",-1)])]),_:1})]),default:a(()=>[e(w,{model:o,"label-width":"120px"},{default:a(()=>[e(u,{label:"Nama"},{default:a(()=>[e(D,{modelValue:o.name,"onUpdate:modelValue":s[1]||(s[1]=l=>o.name=l),placeholder:"Nama relay"},null,8,["modelValue"])]),_:1}),e(u,{label:"Source URL"},{default:a(()=>[e(D,{modelValue:o.source_url,"onUpdate:modelValue":s[2]||(s[2]=l=>o.source_url=l),placeholder:"http://example.com/stream.m3u8",type:"textarea",rows:2},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},je=K(Ke,[["__scopeId","data-v-228e7d3e"]]),qe={class:"users-view"},Oe={__name:"UsersView",setup(Y){const $=h([]),C=h(!1),r=h(!1),d=h(!1),o=h(!1),S=h(30),_=h(null),n=N({username:"",password:"",max_devices:1,expiry_date:new Date(Date.now()+30*24*60*60*1e3)}),f=N({id:null,username:"",max_devices:1,expiry_date:null}),M=async()=>{C.value=!0;try{const v=await R.get("/api/users");$.value=v.data||[]}catch(v){console.error("Error loading users:",v),c.error("Gagal memuat users")}finally{C.value=!1}},m=async()=>{var v,l;if(!n.username||!n.password){c.warning("Username dan password harus diisi");return}try{await R.post("/api/users",{...n,expiry_date:n.expiry_date.toISOString()}),c.success("User berhasil ditambahkan"),r.value=!1,Object.assign(n,{username:"",password:"",max_devices:1,expiry_date:new Date(Date.now()+30*24*60*60*1e3)}),M()}catch(z){c.error(((l=(v=z.response)==null?void 0:v.data)==null?void 0:l.error)||"Gagal menambahkan user")}},s=v=>{f.id=v.id,f.username=v.username,f.max_devices=v.max_devices,f.expiry_date=new Date(v.expiry_date),d.value=!0},i=async()=>{try{await R.put(`/api/users/${f.id}`,{max_devices:f.max_devices,expiry_date:f.expiry_date.toISOString()}),c.success("User berhasil diupdate"),d.value=!1,M()}catch{c.error("Gagal mengupdate user")}},U=async v=>{try{await J.confirm(`Hapus user "${v.username}"?`,"Konfirmasi",{confirmButtonText:"Ya",cancelButtonText:"Batal",type:"warning"}),await R.delete(`/api/users/${v.id}`),c.success("User berhasil dihapus"),M()}catch(l){l!=="cancel"&&c.error("Gagal menghapus user")}},P=v=>{_.value=v,S.value=30,o.value=!0},G=async()=>{try{await R.post(`/api/users/${_.value.id}/extend`,{days:S.value}),c.success(`Subscription diperpanjang ${S.value} hari`),o.value=!1,M()}catch{c.error("Gagal memperpanjang subscription")}},I=v=>{const l=`${window.location.origin}/playlist/${v.username}`;navigator.clipboard.writeText(l),c.success("Playlist URL berhasil disalin")},D=v=>{c.info("Fitur view channels akan segera tersedia")},u=v=>v?new Date(v).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric"}):"-",w=v=>v?new Date(v)<new Date:!0,g=v=>w(v)?"danger":Math.floor((new Date(v)-new Date)/(1e3*60*60*24))<7?"warning":"success";return q(()=>{M()}),(v,l)=>{const z=t("el-icon"),B=t("el-button"),E=t("el-table-column"),F=t("el-tag"),O=t("el-button-group"),T=t("el-table"),Q=t("el-input"),b=t("el-form-item"),j=t("el-input-number"),re=t("el-date-picker"),ae=t("el-form"),le=t("el-dialog"),ie=ne("loading");return x(),H("div",qe,[e(B,{type:"primary",onClick:l[0]||(l[0]=y=>r.value=!0),style:{"margin-bottom":"20px"}},{default:a(()=>[e(z,null,{default:a(()=>[e(V(ve))]),_:1}),l[15]||(l[15]=p(" Tambah User Baru ",-1))]),_:1}),oe((x(),L(T,{data:$.value,style:{width:"100%"}},{default:a(()=>[e(E,{label:"Username",prop:"username",width:"150"}),e(E,{label:"Max Devices",prop:"max_devices",width:"120"}),e(E,{label:"Expiry Date",width:"180"},{default:a(({row:y})=>[e(F,{type:g(y.expiry_date)},{default:a(()=>[p(A(u(y.expiry_date)),1)]),_:2},1032,["type"])]),_:1}),e(E,{label:"Status",width:"100"},{default:a(({row:y})=>[w(y.expiry_date)?(x(),L(F,{key:0,type:"danger"},{default:a(()=>[...l[16]||(l[16]=[p("Expired",-1)])]),_:1})):(x(),L(F,{key:1,type:"success"},{default:a(()=>[...l[17]||(l[17]=[p("Active",-1)])]),_:1}))]),_:1}),e(E,{label:"Channels",width:"100"},{default:a(({row:y})=>[p(A(y.channel_count||0),1)]),_:1}),e(E,{label:"Aksi",width:"350",fixed:"right"},{default:a(({row:y})=>[e(O,null,{default:a(()=>[e(B,{size:"small",onClick:Z=>I(y)},{default:a(()=>[...l[18]||(l[18]=[p(" ðŸ“‹ Copy URL ",-1)])]),_:1},8,["onClick"]),e(B,{size:"small",onClick:Z=>D(y)},{default:a(()=>[...l[19]||(l[19]=[p(" ðŸ“º Channels ",-1)])]),_:1},8,["onClick"]),e(B,{size:"small",type:"success",onClick:Z=>P(y)},{default:a(()=>[...l[20]||(l[20]=[p(" âž• Perpanjang ",-1)])]),_:1},8,["onClick"]),e(B,{size:"small",onClick:Z=>s(y)},{default:a(()=>[...l[21]||(l[21]=[p(" âœï¸ Edit ",-1)])]),_:1},8,["onClick"]),e(B,{size:"small",type:"danger",onClick:Z=>U(y)},{default:a(()=>[...l[22]||(l[22]=[p(" ðŸ—‘ï¸ Hapus ",-1)])]),_:1},8,["onClick"])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[ie,C.value]]),e(le,{modelValue:r.value,"onUpdate:modelValue":l[6]||(l[6]=y=>r.value=y),title:"Tambah User Baru",width:"500px"},{footer:a(()=>[e(B,{onClick:l[5]||(l[5]=y=>r.value=!1)},{default:a(()=>[...l[23]||(l[23]=[p("Batal",-1)])]),_:1}),e(B,{type:"primary",onClick:m},{default:a(()=>[...l[24]||(l[24]=[p("Simpan",-1)])]),_:1})]),default:a(()=>[e(ae,{model:n,"label-width":"140px"},{default:a(()=>[e(b,{label:"Username"},{default:a(()=>[e(Q,{modelValue:n.username,"onUpdate:modelValue":l[1]||(l[1]=y=>n.username=y)},null,8,["modelValue"])]),_:1}),e(b,{label:"Password"},{default:a(()=>[e(Q,{modelValue:n.password,"onUpdate:modelValue":l[2]||(l[2]=y=>n.password=y),type:"password","show-password":""},null,8,["modelValue"])]),_:1}),e(b,{label:"Max Devices"},{default:a(()=>[e(j,{modelValue:n.max_devices,"onUpdate:modelValue":l[3]||(l[3]=y=>n.max_devices=y),min:1,max:10},null,8,["modelValue"])]),_:1}),e(b,{label:"Expiry Date"},{default:a(()=>[e(re,{modelValue:n.expiry_date,"onUpdate:modelValue":l[4]||(l[4]=y=>n.expiry_date=y),type:"datetime",placeholder:"Pilih tanggal",format:"YYYY-MM-DD HH:mm",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),e(le,{modelValue:d.value,"onUpdate:modelValue":l[11]||(l[11]=y=>d.value=y),title:"Edit User",width:"500px"},{footer:a(()=>[e(B,{onClick:l[10]||(l[10]=y=>d.value=!1)},{default:a(()=>[...l[25]||(l[25]=[p("Batal",-1)])]),_:1}),e(B,{type:"primary",onClick:i},{default:a(()=>[...l[26]||(l[26]=[p("Simpan",-1)])]),_:1})]),default:a(()=>[e(ae,{model:f,"label-width":"140px"},{default:a(()=>[e(b,{label:"Username"},{default:a(()=>[e(Q,{modelValue:f.username,"onUpdate:modelValue":l[7]||(l[7]=y=>f.username=y),disabled:""},null,8,["modelValue"])]),_:1}),e(b,{label:"Max Devices"},{default:a(()=>[e(j,{modelValue:f.max_devices,"onUpdate:modelValue":l[8]||(l[8]=y=>f.max_devices=y),min:1,max:10},null,8,["modelValue"])]),_:1}),e(b,{label:"Expiry Date"},{default:a(()=>[e(re,{modelValue:f.expiry_date,"onUpdate:modelValue":l[9]||(l[9]=y=>f.expiry_date=y),type:"datetime",placeholder:"Pilih tanggal",format:"YYYY-MM-DD HH:mm",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),e(le,{modelValue:o.value,"onUpdate:modelValue":l[14]||(l[14]=y=>o.value=y),title:"Perpanjang Subscription",width:"400px"},{footer:a(()=>[e(B,{onClick:l[13]||(l[13]=y=>o.value=!1)},{default:a(()=>[...l[27]||(l[27]=[p("Batal",-1)])]),_:1}),e(B,{type:"primary",onClick:G},{default:a(()=>[...l[28]||(l[28]=[p("Perpanjang",-1)])]),_:1})]),default:a(()=>[e(ae,{"label-width":"100px"},{default:a(()=>[e(b,{label:"Tambah Hari"},{default:a(()=>[e(j,{modelValue:S.value,"onUpdate:modelValue":l[12]||(l[12]=y=>S.value=y),min:1,max:365},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}},Qe=K(Oe,[["__scopeId","data-v-91d2ff9f"]]),Je={class:"generate-playlist-view"},We={__name:"GeneratePlaylistView",setup(Y){const $=h([]),C=h([]),r=h(!1),d=h(""),o=N({userId:null,selectedChannels:[]}),S=async()=>{try{const m=await R.get("/api/users");$.value=m.data||[]}catch(m){console.error("Error loading users:",m)}},_=async()=>{if(o.userId)try{const m=await R.get(`/api/users/${o.userId}/channels`);C.value=(m.data||[]).map(s=>({key:s.id,label:s.name,disabled:!1})),o.selectedChannels=C.value.filter(s=>s.assigned).map(s=>s.key)}catch(m){console.error("Error loading channels:",m)}},n=async()=>{if(!o.userId){c.warning("Pilih user terlebih dahulu");return}r.value=!0;try{await R.post(`/api/users/${o.userId}/channels`,{channel_ids:o.selectedChannels});const m=$.value.find(s=>s.id===o.userId);d.value=`${window.location.origin}/playlist/${m.username}`,c.success("Playlist berhasil di-generate")}catch{c.error("Gagal generate playlist")}finally{r.value=!1}},f=()=>{o.userId=null,o.selectedChannels=[],d.value="",C.value=[]},M=()=>{navigator.clipboard.writeText(d.value),c.success("URL berhasil disalin")};return q(()=>{S()}),(m,s)=>{const i=t("el-option"),U=t("el-select"),P=t("el-form-item"),G=t("el-transfer"),I=t("el-button"),D=t("el-form"),u=t("el-card"),w=t("el-input");return x(),H("div",Je,[e(u,null,{header:a(()=>[...s[3]||(s[3]=[k("h3",null,"Generate Playlist untuk User",-1)])]),default:a(()=>[e(D,{model:o,"label-width":"150px"},{default:a(()=>[e(P,{label:"Pilih User"},{default:a(()=>[e(U,{modelValue:o.userId,"onUpdate:modelValue":s[0]||(s[0]=g=>o.userId=g),placeholder:"Pilih user",filterable:"",style:{width:"100%"},onChange:_},{default:a(()=>[(x(!0),H(te,null,se($.value,g=>(x(),L(i,{key:g.id,label:`${g.username} (${g.channel_count||0} channels)`,value:g.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o.userId?(x(),L(P,{key:0,label:"Channels"},{default:a(()=>[e(G,{modelValue:o.selectedChannels,"onUpdate:modelValue":s[1]||(s[1]=g=>o.selectedChannels=g),data:C.value,titles:["Available","Selected"],filterable:"","filter-placeholder":"Cari channel..."},null,8,["modelValue","data"])]),_:1})):W("",!0),e(P,null,{default:a(()=>[e(I,{type:"primary",onClick:n,loading:r.value},{default:a(()=>[...s[4]||(s[4]=[p(" Generate Playlist ",-1)])]),_:1},8,["loading"]),e(I,{onClick:f},{default:a(()=>[...s[5]||(s[5]=[p("Reset",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),d.value?(x(),L(u,{key:0,style:{"margin-top":"20px"}},{header:a(()=>[...s[6]||(s[6]=[k("h3",null,"Playlist URL",-1)])]),default:a(()=>[e(w,{modelValue:d.value,"onUpdate:modelValue":s[2]||(s[2]=g=>d.value=g),readonly:""},{append:a(()=>[e(I,{onClick:M},{default:a(()=>[...s[7]||(s[7]=[p("ðŸ“‹ Copy",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})):W("",!0)])}}},Xe=K(We,[["__scopeId","data-v-2e5778a6"]]),Ze={class:"import-m3u-view"},ea={__name:"ImportM3UView",setup(Y){const $=X(),C=h(!1),r=N({name:"",url:""}),d=N({message:"",type:"success"}),o=async()=>{var _,n;if(!r.name||!r.url){c.warning("Nama dan URL harus diisi");return}C.value=!0,d.message="";try{const f=await R.post("/api/playlists/import",{name:r.name,url:r.url});d.message=f.data.message||"Playlist berhasil diimport",d.type="success",c.success("Playlist berhasil diimport"),setTimeout(()=>{S(),$.loadStats()},2e3)}catch(f){d.message=((n=(_=f.response)==null?void 0:_.data)==null?void 0:n.error)||"Gagal mengimport playlist",d.type="error",c.error(d.message)}finally{C.value=!1}},S=()=>{r.name="",r.url="",d.message=""};return(_,n)=>{const f=t("el-input"),M=t("el-form-item"),m=t("el-button"),s=t("el-form"),i=t("el-alert"),U=t("el-card");return x(),H("div",Ze,[e(U,null,{header:a(()=>[...n[3]||(n[3]=[k("h3",null,"Import M3U Playlist",-1)])]),default:a(()=>[e(s,{model:r,"label-width":"150px"},{default:a(()=>[e(M,{label:"Nama Playlist"},{default:a(()=>[e(f,{modelValue:r.name,"onUpdate:modelValue":n[0]||(n[0]=P=>r.name=P),placeholder:"Masukkan nama playlist"},null,8,["modelValue"])]),_:1}),e(M,{label:"URL M3U"},{default:a(()=>[e(f,{modelValue:r.url,"onUpdate:modelValue":n[1]||(n[1]=P=>r.url=P),type:"textarea",rows:3,placeholder:"http://example.com/playlist.m3u"},null,8,["modelValue"])]),_:1}),e(M,null,{default:a(()=>[e(m,{type:"primary",onClick:o,loading:C.value},{default:a(()=>[...n[4]||(n[4]=[p(" Import Playlist ",-1)])]),_:1},8,["loading"]),e(m,{onClick:S},{default:a(()=>[...n[5]||(n[5]=[p("Reset",-1)])]),_:1})]),_:1})]),_:1},8,["model"]),d.message?(x(),L(i,{key:0,title:d.message,type:d.type,"show-icon":"",style:{"margin-top":"20px"},closable:"",onClose:n[2]||(n[2]=P=>d.message="")},null,8,["title","type"])):W("",!0)]),_:1})])}}},aa=K(ea,[["__scopeId","data-v-0cb131ae"]]),la={class:"header-content"},ta={class:"user-section"},sa={class:"username"},na={class:"stats-container"},oa={class:"bandwidth-container"},ra={__name:"Dashboard",setup(Y){const $=be(),C=we(),r=X(),d=h("playlists"),o=h(!1),S=h(),_=N({oldPassword:"",newPassword:"",confirmPassword:""}),n={oldPassword:[{required:!0,message:"Password lama harus diisi",trigger:"blur"}],newPassword:[{required:!0,message:"Password baru harus diisi",trigger:"blur"},{min:6,message:"Password minimal 6 karakter",trigger:"blur"}],confirmPassword:[{required:!0,message:"Konfirmasi password harus diisi",trigger:"blur"},{validator:(s,i,U)=>{i!==_.newPassword?U(new Error("Password tidak sama")):U()},trigger:"blur"}]};let f=null;const M=()=>{C.logout(),$.push("/login")},m=async()=>{S.value&&await S.value.validate(async s=>{if(!s)return;const i=await C.changePassword(_.oldPassword,_.newPassword);i.success?(c.success("Password berhasil diubah"),o.value=!1,_.oldPassword="",_.newPassword="",_.confirmPassword=""):c.error(i.message)})};return q(()=>{r.loadStats(),r.loadBandwidth(),f=setInterval(()=>{r.loadBandwidth()},2e3)}),ge(()=>{f&&clearInterval(f)}),(s,i)=>{const U=t("el-icon"),P=t("el-button"),G=t("el-header"),I=t("el-statistic"),D=t("el-card"),u=t("el-col"),w=t("el-row"),g=t("el-tab-pane"),v=t("el-tabs"),l=t("el-main"),z=t("el-input"),B=t("el-form-item"),E=t("el-form"),F=t("el-dialog"),O=t("el-container");return x(),L(O,{class:"dashboard-container"},{default:a(()=>[e(G,{class:"dashboard-header"},{default:a(()=>[k("div",la,[i[9]||(i[9]=k("div",{class:"logo-section"},[k("h1",null,"ðŸŽ¬ IPTV Panel"),k("p",null,"Kelola Playlist & Stream Relay IPTV Anda")],-1)),k("div",ta,[k("span",sa,A(V(C).username),1),e(P,{type:"primary",onClick:i[0]||(i[0]=T=>o.value=!0)},{default:a(()=>[e(U,null,{default:a(()=>[e(V(he))]),_:1}),i[7]||(i[7]=p(" Ganti Password ",-1))]),_:1}),e(P,{onClick:M},{default:a(()=>[e(U,null,{default:a(()=>[e(V(xe))]),_:1}),i[8]||(i[8]=p(" Logout ",-1))]),_:1})])])]),_:1}),k("div",na,[e(w,{gutter:20},{default:a(()=>[e(u,{xs:12,sm:6},{default:a(()=>[e(D,{class:"stat-card"},{default:a(()=>[e(I,{title:"Total Playlists",value:V(r).stats.total_playlists},{prefix:a(()=>[e(U,null,{default:a(()=>[e(V(Ce))]),_:1})]),_:1},8,["value"])]),_:1})]),_:1}),e(u,{xs:12,sm:6},{default:a(()=>[e(D,{class:"stat-card"},{default:a(()=>[e(I,{title:"Total Channels",value:V(r).stats.total_channels},{prefix:a(()=>[e(U,null,{default:a(()=>[e(V(Ve))]),_:1})]),_:1},8,["value"])]),_:1})]),_:1}),e(u,{xs:12,sm:6},{default:a(()=>[e(D,{class:"stat-card"},{default:a(()=>[e(I,{title:"Active Channels",value:V(r).stats.active_channels},{prefix:a(()=>[e(U,null,{default:a(()=>[e(V(ke))]),_:1})]),_:1},8,["value"])]),_:1})]),_:1}),e(u,{xs:12,sm:6},{default:a(()=>[e(D,{class:"stat-card"},{default:a(()=>[e(I,{title:"Total Relays",value:V(r).stats.total_relays},{prefix:a(()=>[e(U,null,{default:a(()=>[e(V(Ue))]),_:1})]),_:1},8,["value"])]),_:1})]),_:1})]),_:1})]),k("div",oa,[e(D,null,{header:a(()=>[...i[10]||(i[10]=[k("div",{class:"card-header"},[k("span",null,"ðŸ“Š Bandwidth Monitor")],-1)])]),default:a(()=>[e(w,{gutter:15},{default:a(()=>[e(u,{xs:12,sm:6},{default:a(()=>[e(I,{title:"â¬‡ï¸ Download (Mbps)",value:V(r).bandwidth.downloadMbps,precision:2},null,8,["value"])]),_:1}),e(u,{xs:12,sm:6},{default:a(()=>[e(I,{title:"â¬†ï¸ Upload (Mbps)",value:V(r).bandwidth.uploadMbps,precision:2},null,8,["value"])]),_:1}),e(u,{xs:12,sm:6},{default:a(()=>[e(I,{title:"ðŸ“¥ Total Download (MB)",value:V(r).bandwidth.totalDownloadMB,precision:2},null,8,["value"])]),_:1}),e(u,{xs:12,sm:6},{default:a(()=>[e(I,{title:"ðŸ“¤ Total Upload (MB)",value:V(r).bandwidth.totalUploadMB,precision:2},null,8,["value"])]),_:1})]),_:1})]),_:1})]),e(l,{class:"dashboard-main"},{default:a(()=>[e(v,{modelValue:d.value,"onUpdate:modelValue":i[1]||(i[1]=T=>d.value=T),type:"border-card"},{default:a(()=>[e(g,{label:"Playlists",name:"playlists"},{default:a(()=>[e(Re)]),_:1}),e(g,{label:"Channels",name:"channels"},{default:a(()=>[e(Ye)]),_:1}),e(g,{label:"Relays",name:"relays"},{default:a(()=>[e(je)]),_:1}),e(g,{label:"Users",name:"users"},{default:a(()=>[e(Qe)]),_:1}),e(g,{label:"Generate Playlist",name:"generate"},{default:a(()=>[e(Xe)]),_:1}),e(g,{label:"Import M3U",name:"import"},{default:a(()=>[e(aa)]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(F,{modelValue:o.value,"onUpdate:modelValue":i[6]||(i[6]=T=>o.value=T),title:"Ganti Password",width:"400px"},{footer:a(()=>[e(P,{onClick:i[5]||(i[5]=T=>o.value=!1)},{default:a(()=>[...i[11]||(i[11]=[p("Batal",-1)])]),_:1}),e(P,{type:"primary",onClick:m},{default:a(()=>[...i[12]||(i[12]=[p("Simpan",-1)])]),_:1})]),default:a(()=>[e(E,{ref_key:"passwordFormRef",ref:S,model:_,rules:n},{default:a(()=>[e(B,{label:"Password Lama",prop:"oldPassword"},{default:a(()=>[e(z,{modelValue:_.oldPassword,"onUpdate:modelValue":i[2]||(i[2]=T=>_.oldPassword=T),type:"password","show-password":""},null,8,["modelValue"])]),_:1}),e(B,{label:"Password Baru",prop:"newPassword"},{default:a(()=>[e(z,{modelValue:_.newPassword,"onUpdate:modelValue":i[3]||(i[3]=T=>_.newPassword=T),type:"password","show-password":""},null,8,["modelValue"])]),_:1}),e(B,{label:"Konfirmasi Password",prop:"confirmPassword"},{default:a(()=>[e(z,{modelValue:_.confirmPassword,"onUpdate:modelValue":i[4]||(i[4]=T=>_.confirmPassword=T),type:"password","show-password":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])]),_:1})}}},ua=K(ra,[["__scopeId","data-v-e2a76567"]]);export{ua as default};
