var w=(k,v,n)=>new Promise((u,r)=>{var p=i=>{try{c(n.next(i))}catch(o){r(o)}},x=i=>{try{c(n.throw(i))}catch(o){r(o)}},c=i=>i.done?u(i.value):Promise.resolve(i.value).then(p,x);c((n=n.apply(k,v)).next())});import{_ as D}from"./ContentWrap.vue_vue_type_script_setup_true_lang-C3jeulgB.js";import{e as y,r as b}from"./index-DTPVUMgb.js";/* empty css                        *//* empty css                    *//* empty css                  *//* empty css               *//* empty css                  *//* empty css                     */import{c as f,q as L,r as g,s as E,t as T,u as B,v as V,w as U,b as d,k as F}from"./element-plus-B47XQz09.js";import{j as I,r as _,N as M,e as S,ac as q,C,l as R,D as t,G as l,L as z,u as a,_ as m}from"./vue-chunks-B2QQ4E8c.js";const Y=I({__name:"Relays",setup(k){const v=_([]),n=_(!1),u=_(!1),r=M({name:"",source_url:""}),p=()=>w(this,null,function*(){n.value=!0;try{const o=yield b.get({url:"/api/relays"});o&&o.data&&(v.value=o.data)}catch(o){console.error("Error loading relays:",o),d.error("Failed to load relays")}finally{n.value=!1}}),x=()=>w(this,null,function*(){if(!r.name||!r.source_url){d.warning("Name and Source URL are required");return}try{yield b.post({url:"/api/relays",data:r}),d.success("Relay created successfully"),u.value=!1,r.name="",r.source_url="",p()}catch(o){d.error("Failed to create relay")}}),c=o=>w(this,null,function*(){try{yield F.confirm(`Delete relay "${o.name}"?`,"Confirm",{confirmButtonText:"Delete",cancelButtonText:"Cancel",type:"warning"}),yield b.delete({url:`/api/relays/${o.id}`}),d.success("Relay deleted successfully"),p()}catch(e){e!=="cancel"&&d.error("Failed to delete relay")}}),i=o=>{const e=`${window.location.origin}/relay/${o.id}/playlist.m3u8`;navigator.clipboard.writeText(e),d.success("URL copied to clipboard")};return S(()=>{p()}),(o,e)=>{const $=q("loading");return R(),C(a(D),{title:"Relays",message:"Manage stream relays"},{default:t(()=>[l(a(f),{type:"primary",onClick:e[0]||(e[0]=s=>u.value=!0),style:{"margin-bottom":"16px"}},{icon:t(()=>[l(a(y),{icon:"ep:plus"})]),default:t(()=>[e[5]||(e[5]=m(" Create New Relay "))]),_:1}),z((R(),C(a(L),{data:v.value,style:{width:"100%"}},{default:t(()=>[l(a(g),{prop:"name",label:"Name","min-width":"150"}),l(a(g),{prop:"source_url",label:"Source URL","min-width":"300","show-overflow-tooltip":""}),l(a(g),{label:"Status",width:"120"},{default:t(({row:s})=>[s.active?(R(),C(a(E),{key:0,type:"success"},{default:t(()=>[l(a(y),{icon:"ep:video-play"}),e[6]||(e[6]=m(" Active "))]),_:1})):(R(),C(a(E),{key:1,type:"info"},{default:t(()=>[l(a(y),{icon:"ep:video-pause"}),e[7]||(e[7]=m(" Inactive "))]),_:1}))]),_:1}),l(a(g),{label:"Actions",width:"200",fixed:"right"},{default:t(({row:s})=>[l(a(f),{type:"primary",size:"small",text:"",onClick:N=>i(s)},{icon:t(()=>[l(a(y),{icon:"ep:document-copy"})]),default:t(()=>[e[8]||(e[8]=m(" Copy URL "))]),_:2},1032,["onClick"]),l(a(f),{type:"danger",size:"small",onClick:N=>c(s)},{icon:t(()=>[l(a(y),{icon:"ep:delete"})]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[$,n.value]]),l(a(T),{modelValue:u.value,"onUpdate:modelValue":e[4]||(e[4]=s=>u.value=s),title:"Create New Relay",width:"500px"},{footer:t(()=>[l(a(f),{onClick:e[3]||(e[3]=s=>u.value=!1)},{default:t(()=>e[9]||(e[9]=[m("Cancel")])),_:1}),l(a(f),{type:"primary",onClick:x},{default:t(()=>e[10]||(e[10]=[m("Create")])),_:1})]),default:t(()=>[l(a(B),{model:r,"label-width":"120px"},{default:t(()=>[l(a(V),{label:"Name"},{default:t(()=>[l(a(U),{modelValue:r.name,"onUpdate:modelValue":e[1]||(e[1]=s=>r.name=s),placeholder:"Relay name"},null,8,["modelValue"])]),_:1}),l(a(V),{label:"Source URL"},{default:t(()=>[l(a(U),{modelValue:r.source_url,"onUpdate:modelValue":e[2]||(e[2]=s=>r.source_url=s),type:"textarea",rows:3,placeholder:"http://example.com/stream.m3u8"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])]),_:1})}}});export{Y as default};
