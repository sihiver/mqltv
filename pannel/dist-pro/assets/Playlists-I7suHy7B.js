var _=(P,m,o)=>new Promise((d,n)=>{var f=r=>{try{y(o.next(r))}catch(v){n(v)}},D=r=>{try{y(o.throw(r))}catch(v){n(v)}},y=r=>r.done?d(r.value):Promise.resolve(r.value).then(f,D);y((o=o.apply(P,m)).next())});import{_ as L}from"./ContentWrap.vue_vue_type_script_setup_true_lang-C2ZlXlGE.js";import{e as w,r as x}from"./index-edGwmMvL.js";/* empty css                        *//* empty css                    *//* empty css                  *//* empty css               *//* empty css                  *//* empty css                     */import{q as M,r as h,c as C,t as N,u as I,v as U,w as $,b as p,k as T}from"./element-plus-B47XQz09.js";import{j as z,r as E,e as j,a5 as q,ac as S,C as B,l as R,D as i,L as A,G as a,u as l,t as V,I as b,_ as c}from"./vue-chunks-B2QQ4E8c.js";const G={style:{display:"flex","align-items":"center",gap:"8px"}},H={style:{display:"flex",gap:"8px","justify-content":"center"}},te=z({__name:"Playlists",setup(P){const m=E([]),o=E(!1),d=E(!1),n=E({id:0,name:"",url:""}),f=()=>_(this,null,function*(){o.value=!0;try{const t=yield x.get({url:"/api/playlists"});t&&t.data&&(m.value=t.data)}catch(t){console.error("Error loading playlists:",t),p.error("Failed to load playlists")}finally{o.value=!1}}),D=t=>{n.value={id:t.id,name:t.name,url:t.url},d.value=!0},y=()=>_(this,null,function*(){try{yield x.put({url:`/api/playlists/${n.value.id}`,data:{name:n.value.name,url:n.value.url}}),p.success("Playlist updated successfully"),d.value=!1,f()}catch(t){p.error("Failed to update playlist")}}),r=(t,e)=>_(this,null,function*(){var u;try{yield T.confirm(`Re-import playlist "${e}" from its URL? This will update all channels.`,"Confirm Refresh",{confirmButtonText:"Refresh",cancelButtonText:"Cancel",type:"info"}),o.value=!0;const g=yield x.post({url:`/api/playlists/${t}/refresh`});p.success(`Playlist refreshed! ${((u=g.data)==null?void 0:u.channels_count)||0} channels updated`),f()}catch(g){g!=="cancel"&&p.error("Failed to refresh playlist")}finally{o.value=!1}}),v=(t,e)=>_(this,null,function*(){try{yield T.confirm(`Delete playlist "${e}" and all its channels?`,"Confirm",{confirmButtonText:"Delete",cancelButtonText:"Cancel",type:"warning"}),o.value=!0,yield x.delete({url:`/api/playlists/${t}`}),m.value=m.value.filter(u=>u.id!==t),p.success("Playlist deleted successfully")}catch(u){u!=="cancel"&&p.error("Failed to delete playlist")}finally{o.value=!1}}),F=t=>t?new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"-";return j(()=>{f()}),(t,e)=>{const u=q("ElTag"),g=S("loading");return R(),B(l(L),{title:"Playlists",message:"Manage your M3U playlists"},{default:i(()=>[A((R(),B(l(M),{data:m.value,style:{width:"100%"}},{default:i(()=>[a(l(h),{prop:"name",label:"Playlist Name","min-width":"200"},{default:i(({row:s})=>[V("div",G,[a(l(w),{icon:"ep:folder"}),V("strong",null,b(s.name),1)])]),_:1}),a(l(h),{prop:"url",label:"URL","min-width":"300","show-overflow-tooltip":""}),a(l(h),{prop:"channel_count",label:"Channels",width:"120",align:"center"},{default:i(({row:s})=>[a(u,{type:"primary"},{default:i(()=>[c(b(s.channel_count||0),1)]),_:2},1024)]),_:1}),a(l(h),{prop:"created_at",label:"Created",width:"180"},{default:i(({row:s})=>[c(b(F(s.created_at)),1)]),_:1}),a(l(h),{label:"Actions",width:"280",fixed:"right",align:"center"},{default:i(({row:s})=>[V("div",H,[a(l(C),{type:"primary",size:"small",onClick:k=>D(s)},{default:i(()=>[a(l(w),{icon:"ep:edit"}),e[4]||(e[4]=c(" Edit "))]),_:2},1032,["onClick"]),a(l(C),{type:"success",size:"small",onClick:k=>r(s.id,s.name)},{default:i(()=>[a(l(w),{icon:"ep:refresh"}),e[5]||(e[5]=c(" Refresh "))]),_:2},1032,["onClick"]),a(l(C),{type:"danger",size:"small",onClick:k=>v(s.id,s.name)},{default:i(()=>[a(l(w),{icon:"ep:delete"}),e[6]||(e[6]=c(" Delete "))]),_:2},1032,["onClick"])])]),_:1})]),_:1},8,["data"])),[[g,o.value]]),a(l(N),{modelValue:d.value,"onUpdate:modelValue":e[3]||(e[3]=s=>d.value=s),title:"Edit Playlist",width:"500px"},{footer:i(()=>[a(l(C),{onClick:e[2]||(e[2]=s=>d.value=!1)},{default:i(()=>e[7]||(e[7]=[c("Cancel")])),_:1}),a(l(C),{type:"primary",onClick:y},{default:i(()=>e[8]||(e[8]=[c("Update")])),_:1})]),default:i(()=>[a(l(I),{model:n.value,"label-width":"100px"},{default:i(()=>[a(l(U),{label:"Name"},{default:i(()=>[a(l($),{modelValue:n.value.name,"onUpdate:modelValue":e[0]||(e[0]=s=>n.value.name=s),placeholder:"Playlist name"},null,8,["modelValue"])]),_:1}),a(l(U),{label:"URL"},{default:i(()=>[a(l($),{modelValue:n.value.url,"onUpdate:modelValue":e[1]||(e[1]=s=>n.value.url=s),placeholder:"M3U URL"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])]),_:1})}}});export{te as default};
